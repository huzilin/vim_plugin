'''
#  =============================================================================
#       FileName: db_opers.py
#           Desc: 
#         Author: Hu Zilin
#          Email: zilin.hu@greatopensource.com
#        Created: 2016-07-20 14:37:00
#        Version: 0.0.1
#     LastChange: 2016-07-20 16:11:13
#        History:
#                 0.0.1 | Hu Zilin | init
#  =============================================================================
'''
import MySQLdb
import logging


class DBOpers(object):

    def get_mysql_connection(self, host ='127.0.0.1', user="root", passwd='123', port=3306, autocommit = True):
        conn = None
        
        try:
            conn=MySQLdb.connect(host, user, passwd, port=port)
            conn.autocommit(autocommit)
        except Exception,e:
            logging.error(e)
        return conn

    def get_table_data(self, conn, db_name, tb_name):
        
        conn.select_db(db_name)
        cursor = conn.cursor()
        try :
            sql = "select * from `%s`" % (tb_name)
            print sql
            cursor.execute(sql)
            rows = cursor.fetchall()
        
        except Exception, e :
            logging.error(e)
        finally:
            cursor.close()
        return rows


db_opers = DBOpers()
