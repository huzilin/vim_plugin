import sys

sys.path.append("..")
from include.unpack_byte import *


class Rotate_Event:

    """
    4
    rotate_to_log_file_len = event_size - common_header_len -\
    rotate_to_pos_len [- CRC32_len (if CRC32_flag == 1)]
    """
    rotate_to_pos_len = 8

    def __init__(self, post_buf):
        self.parse = unpack_byte.Parse_Byte_Stream(post_buf)
        self.rotate_to_pos = self.parse.get_uint64()
        self.rotate_to_log_file =\
            self.parse.get_char(len(post_buf) -
                                Rotate_Event.rotate_to_pos_len)

    def event_output(self):
        print "rotate_to_pos: %d" % self.rotate_to_pos
        print "rotate_to_log_file: %s" % self.rotate_to_log_file
